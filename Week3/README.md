# Настройка 

## Сборка образа 

Для запуска докер контейнера необходимо написать 

```bash
docker-compose up --build -d
```

## Запуск psql

Для подключения к postgres СУБД можно воспользоваться командой 

```bash 
docker exec -it postgres_hw2 psql -U postgres
```

или настроить коннект в одной из доступных IDE. 


# Задание 

Домашнее задание состоит из 10 заданий. Студент подготавливает архив homework с 10 файлами с названием hw2_task<номер заания>.sql. В скобках к заданию написаны названия полей для вывода. 

Для заданий предполагается база данных chinook.
[схема базы данных](https://github.com/lerocha/chinook-database/wiki/Chinook-Schema)

Только вместо caseCamel используется подчеркивание. Например, вместо поля AlbumId -> album_id

## Задание 1
Вывести все альбомы со средней длинной трека, большей 250 секунд. Вывести название альбома и количество треков. (album_name, cnt).

## Задание 2 
Для каждого набора жанр, тип медиа вывести количество треков. Если для набора жанр, тип медиа треков нет, то такой набор выводить не требуется. (genre_name, media_type_name, cnt)

## Задание 3
Вывести сотрудников, которые старше своего менеджера, но были наняты позже своего менеджера. Вывести полное имя сотрудника(Фамилия<Пробел>Имя), день рождения, дата найма, полное имя менеджера, день рождения, дата найма. (employee_full_name, employee_birth_date, employee_hire_date, manager_full_name, manager_birth_date, manager_hire_date)

## Задание 4 
Для всех треков жанра Rock и Metal, для каждого артиста подсчитать количество треков. Вывести имя артиста, количество треков. (artist_name, qty)

## Задание 5 
Для каждого сотрудника подсчитать количество клиентов, количестов выполненных заказов, количество уникальных адресов доставки и общее число приобретенных треков и вывести полное имя сотрудника. (employee_full_name, invoices_count, customers_count, addresses_count, tracks_count)

## Задание 6 
Выполнить сегментацию клиентов по количеству букв а в его фамилии - Группа 'A' - 0 букв, 'B' - 1 буква, 'C' - 2 буквы, 'D' - 3 и более букв. Для каждой группы вывести количество уникальных типов медиа, купленных клиентами по трекам из различных жанров метала. Вывести имя группы и количество уникальных типов медиа (segment_group, cnt)

## Задание 7 
Вывести компании, которые приобрели больше всех композиций по каждому из жанров. При этом указать самую популярную композицию по жанру у данной компании. (популярность определяется по количеству покупок) (company_name, track_name)

## Задание 8
Вывести треки по каждому жанру, которые входять в самые популярные 25% с точки зрения количества покупок. Если у нескольких треков одиннаковоко количество приобретенных композиций, популярность определяется в лексикографическом порядке (Например, трек, начинающийся с 'A' будет более популярен, чем трек, начинающийся с 'B'). Для каждого трека указать популярность в процентах от общего количества покупок по жанру.  (track_name, popularity)

## Задание 9 
Для каждого альбома жанр определяется как наибольшая суммарная продолжительность треков по жанру. Вывести альбом, жанр, и общее количество купленных песен по нему. (album_name, genre_name, cnt)


## Задание 10
Для каждого альбома тип медиа определяется как наибольшая суммарный размер треков по жанру. Для каждого исполнителя вывести тип медиа, соответствующий наибольшему количеству типо медиа по альбомам, где они участвуют. Вывести имя исполнителя, тип медиа, количество альбомов с данными типом, общее количество альбомов. (artist_name, media_type_name, media_cnt, whole_cnt)
